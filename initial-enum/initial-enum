#!/bin/bash

# Check arguments
if [ $# -eq 0 ]
  then
    echo "No arguments supplied. Please supply a valid IP address to scan"
    exit
fi

# Colors
GREEN="\e[32m"
BLUE="\e[34m"
ENDCOLOR="\e[0m"
SUCCESS="${GREEN}[+]${ENDCOLOR}"
INFO="${BLUE}[*]${ENDCOLOR}"

# Function that performs enumeration
printf "$SUCCESS Scanning $1 with Nmap...\n" 
ports=$(sudo nmap -Pn -T5 -p- $1 -v | grep Discovered | awk -F " " '{print substr($4,1,length($4)-4)}')
printf "$SUCCESS Ports found by nmap:\n"
for port in `echo $ports`; 
do
	printf "$INFO $port\n"
done

printf "$PLUS Running autorecon now...\n"
autorecon $1 -p $(echo $ports | tr ' ' ',')
